#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import cv2
import numpy as np
import rospy
from find_object_2d.msg import ObjectsStamped
from sensor_msgs.msg import Image
from geometry_msgs.msg import Twist
from cv_bridge import CvBridge

class objeTespit():
    def __init__(self):
        rospy.init_node("obje_tespit")
        self.bridge = CvBridge()
        rospy.Subscriber("camera/rgb/image_raw", Image, self.nesne_tespit)
    
        rospy.spin()
        

    def nesne_tespit(self,mesaj):
            
            img = self.bridge.imgmsg_to_cv2(mesaj,"mono8")
            img2 = self.bridge.imgmsg_to_cv2(mesaj,"bgr8")
            ret,esikli = cv2.threshold(img,127,255,cv2.THRESH_BINARY_INV)                                                              
            sinirlar,hiyerarsi = cv2.findContours(esikli,cv2.RETR_LIST,cv2.CHAIN_APPROX_SIMPLE)
            cv2.drawContours(img2,sinirlar,-1,(255,0,0),5)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            cnt = sinirlar[0]
            M=cv2.moments(cnt)
            cx = int(M['m10']/M['m00'])
            cy = int(M['m01']/M['m00'])
            print("Cismin Agirlik Merkezi = ",cx,cy,"  Nesne ID = ")
     

objeTespit()


        
        
        
        
